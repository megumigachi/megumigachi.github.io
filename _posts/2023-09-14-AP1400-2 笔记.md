---
layout: post
title: "AP1400-2笔记--lab总结"
categories:
  - c++
toc: true
toc_sticky: true
toc_label: 目录
---


## 为什么要做这个lab

组内相当一部分的工作内容技术栈都是c++，因此作为铁血java孝子的我也不得不加入了c++的行列。不得不说c++是真的有点难，虽然一般认为语言只是工具，但这玩意首先编译、调试、报错等各方面就非常不友好，语言特性更是多到淌口水，只能以“初学者”的心态重新学起了。

鉴于本人非常非常不喜欢啃很厚的书，还是决定从lab开始，在csdiy.wiki上挑挑拣拣还是从AP1400-2开始（这甚至是c++入门中lab风评最好的一门课），虽然在wiki上被标注了五颗星的难度，但是感觉这个lab只能算是差强人意。陷入沉思，接下来是接着刷cs144之类的c++系lab还是找点其他项目？难道说真的得从《c++ Primer》看起？

言归正传，本篇博客将回顾一下AP1400-2lab中的内容，以一个有一点点计算机基础，但总得来说还算是初学者的人的视角，讲讲lab中的收获和踩坑，附带一些个人的主观评价。

## 写在前面
AP1400-2是AUT的一门编程课程，这里的AUT我一开始还以为是新西兰的奥克兰理工大学，后来查了才知道是伊朗的一所学校（这里有伏笔），不得不说伊朗居然还有教学理念这么领先（相对国内）的学校么？

该课程找不到课程主页，所有lab在都在[Github](https://github.com/courseworks)上可以找到，共有七个lab，相互独立，相对来说较为简单，适合入门，规模都在几百行c++代码（除了最后一个是python）。

lab1：实现一个algebra的库

lab2：实现一个类似于加密货币交易的过程

lab3：实现一个二叉搜索树

lab4：实现一部分c++中的智能指针

lab5：实现一些原料和咖啡类

lab6：用STL库解决四个问题

lab7：没做

## hw1

第一个lab就让人非常绷不住，上来就是线代糊脸，我个人是不太推荐lab中有和非cs知识太强关联的，毕竟这样有点舍本逐末了，做这个的时候大脑CPU大部分都分给数学了，对c++的感受较少，做了一半直接润了，这时候这门课所有lab互相独立的好处就体现了。

主要收获：

1、简单的cmakelist怎么写

2、命名空间怎么用，同一个命名空间的内容怎么拆分到头文件和cpp文件中

3、using的用法

评分（值得做的程度）：1分，不做也罢

## hw2

第二个lab中，模拟的其实就是大名鼎鼎的比特币挖矿过程，虽然整体进行了魔改，使用一个中心化的服务器而不是区块链来管理交易。总的来说，我认为这个lab本身设计的非常好，如果是对加密货币交易一无所知，可以对其简化流程有一个不错的了解。

主要收获：

1、class的用法，在头文件中声明类的函数和成员变量，并且在源文件中定义函数

2、全局（extern）变量的声明，并且在源文件中定义

3、如何在c++中实现一个类似于java中的split函数，使用istringstream，并循环使用getline函数

4、了解加密货币交易和挖矿相关概念，非对称加密、数字签名、交易过程

在这篇文章[C++自学总结 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/639754681)中，提到mine的部分描述并不是很清楚，我感觉并非如此，有这种想法可能是对中心化的交易过程先入为主了。mine()实际上模拟的就是挖矿过程，在真实的区块链上，交易会被存储在区块中，直到矿工将该区块挖出，交易的内容才会生效。挖矿的过程实际上就是暴力地计算一个nonce值，附加在交易信息上，使其hash值符合某一条件（在lab中是前十位出现为“000”的字串），成功的矿工会得到一些比特币作为奖励。在没有区块链的情况下，我认为lab中的设计已经最大限度地还原了挖矿的过程，如果了解一下会觉得非常有趣。

评分：4分，非常不错的lab设计，美中不足的是测试用例写的非常谢特，比如没有检测mine()之前会不会交易成功等，这也是这个lab的通病

## hw3

第三个lab是作为leetcode做题家的我喜闻乐见的实现一个BST（还好不是平衡二叉树，谢天谢地），总的来说，是一个还算可以的实践。但是部分内容设计的完全没有道理，比如

```c++
    Node **find_node(int value);
```

很难摸清这个地方用二重指针是什么想法，也许是为了提升这个lab的难度，但我并不是很喜欢这种做法。此外，该lab中会出现一些恼人的拼写问题，如find_successor实际上是想要找前驱节点，也是此时我开始怀疑这个“新西兰大学”的真实性了（伏笔回收）。



主要收获：

1、复习数据结构中平衡二叉树的知识

2、重载运算符的定义和使用

3、列表初始化的写法，参见

```c++
BST::BST(std::initializer_list<int> initList)
```
4、lambda函数的写法，参见

```c++
void BST::bfs(std::function<void(Node *&node)> func)
```

此外，由于该lab中大量使用原始指针，并且在测试用例中并不会进行内存泄漏检查，建议使用valgrind进行检查。虽然现在大量使用智能指针，但是我觉得锻炼一下自己的内存泄漏排查能力也挺有意思的。

评分：3.5分，还可以的实践，测试用例也丰富了一些，但是有些设计实在不敢恭维

## hw4

第四个lab是实现c++中的智能指针，个人认为是非常好的实践，有利于帮助思考c++中的内存管理方式。



主要收获：

1、shared_ptr和unique_ptr大致的实现方式，尤其是shared_ptr，我的实现方法是在其中加了一个控制块管理该对象对应指针数。

2、模板类的写法



评分：4.5分，很不错的一个lab，代码量比较小的同时能加深对内存管理的理解，美中不足的是Test15我觉得写的有些问题，这点之后再讲。


## hw5

第五个lab是实现一个成分和咖啡类，主要用到了一些c++面向对象的知识，个人认为还是可以的。里面还提到了用#define批量定义类的黑科技，但是不太容易调试，谨慎使用。

主要收获：
1、继承、多态、虚函数的基本使用方式，基类和派生类的构造和析构函数的调用顺序。

2、拷贝构造函数与移动构造函数的写法,lab中的

```c++
void Cappuccino::operator=(const Cappuccino &other)
```

实际上要求写一个移动构造函数。

3、抽象函数和抽象类的使用



评分：4.5分，对于继承，多态的理解有着比较大的帮助，包括虚函数该如何使用，定义抽象函数的影响等，可能这个lab本身设计的还有一些问题，但是重要性非常高。


## hw6
第六个lab是使用stl库解决给出的四个问题，说是用stl库，实际上大部分时间（90%以上）都在处理字符串，建议不写，性价比过低

收获：
1、q1可以让你对lambda函数以及std::function有了更深入的理解

评分：q2、q3、q4纯纯的浪费时间，q1可以给个3分吧，虽然知识点偏了点，但还是有点收获的，后三个0分，综合下来豆瓣拒绝评分。